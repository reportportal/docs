"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[2690],{63384:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>c,frontMatter:()=>a,metadata:()=>o,toc:()=>p});const o=JSON.parse('{"id":"installation-steps-advanced/UpgradingPostgreSQLForReportPortalV24.2AndLater","title":"Upgrading PostgreSQL for ReportPortal v24.2 and later","description":"This guide is intended for users planning to upgrade from Postgres 12 to a newer version, starting with ReportPortal version 24.2.","source":"@site/docs/installation-steps-advanced/UpgradingPostgreSQLForReportPortalV24.2AndLater.md","sourceDirName":"installation-steps-advanced","slug":"/installation-steps-advanced/UpgradingPostgreSQLForReportPortalV24.2AndLater","permalink":"/docs/installation-steps-advanced/UpgradingPostgreSQLForReportPortalV24.2AndLater","draft":false,"unlisted":false,"editUrl":"https://github.com/reportportal/docs/blob/develop/docs/installation-steps-advanced/UpgradingPostgreSQLForReportPortalV24.2AndLater.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Quick Start Guide for Google Cloud Platform GKE","permalink":"/docs/installation-steps-advanced/QuickStartWithGCPGKE"},"next":{"title":"Releases","permalink":"/docs/releases/"}}');var s=r(74848),n=r(28453);const a={},l="Upgrading PostgreSQL for ReportPortal v24.2 and later",d={},p=[{value:"Step 0: Backup Postgres and Storage",id:"step-0-backup-postgres-and-storage",level:2},{value:"Step 1: Create a Dump of Database",id:"step-1-create-a-dump-of-database",level:2},{value:"Step 2: Remove All Containers",id:"step-2-remove-all-containers",level:2},{value:"Step 3: Remove Postgres Volume",id:"step-3-remove-postgres-volume",level:2},{value:"Step 4: Download Latest Release",id:"step-4-download-latest-release",level:2},{value:"Step 5: Run Postgres Container",id:"step-5-run-postgres-container",level:2},{value:"Step 6: Restore Postgres Dump",id:"step-6-restore-postgres-dump",level:2},{value:"Step 7: Run ReportPortal",id:"step-7-run-reportportal",level:2},{value:"Final Notes",id:"final-notes",level:2}];function i(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"upgrading-postgresql-for-reportportal-v242-and-later",children:"Upgrading PostgreSQL for ReportPortal v24.2 and later"})}),"\n",(0,s.jsx)(t.admonition,{type:"important",children:(0,s.jsx)(t.p,{children:"This guide is intended for users planning to upgrade from Postgres 12 to a newer version, starting with ReportPortal version 24.2."})}),"\n",(0,s.jsx)(t.p,{children:"This guide will walk you through backing up your current PostgreSQL database, removing existing containers and volumes, downloading the latest release, and restoring the PostgreSQL dump."}),"\n",(0,s.jsx)(t.h2,{id:"step-0-backup-postgres-and-storage",children:"Step 0: Backup Postgres and Storage"}),"\n",(0,s.jsx)(t.p,{children:"Before proceeding, ensure you have a complete Postgres database and Storage backup."}),"\n",(0,s.jsx)(t.h2,{id:"step-1-create-a-dump-of-database",children:"Step 1: Create a Dump of Database"}),"\n",(0,s.jsx)(t.p,{children:"Run the following command to create a dump of your current PostgreSQL database:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"docker exec -t postgres pg_dump -U rpuser -d reportportal > reportportal24_1_postgres12_dump.sql\n"})}),"\n",(0,s.jsx)(t.h2,{id:"step-2-remove-all-containers",children:"Step 2: Remove All Containers"}),"\n",(0,s.jsx)(t.p,{children:"Shut down and remove all containers:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"docker compose -p reportportal down\n"})}),"\n",(0,s.jsx)(t.h2,{id:"step-3-remove-postgres-volume",children:"Step 3: Remove Postgres Volume"}),"\n",(0,s.jsx)(t.p,{children:"Remove the Postgres volume to ensure a clean state for the new database:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"docker volume rm reportportal_postgres\n"})}),"\n",(0,s.jsx)(t.h2,{id:"step-4-download-latest-release",children:"Step 4: Download Latest Release"}),"\n",(0,s.jsxs)(t.p,{children:["Fetch the latest ",(0,s.jsx)(t.code,{children:"docker-compose.yml"})," file to get the most recent version of ReportPortal:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"curl -LO https://raw.githubusercontent.com/reportportal/reportportal/refs/heads/master/docker-compose.yml\n"})}),"\n",(0,s.jsx)(t.h2,{id:"step-5-run-postgres-container",children:"Step 5: Run Postgres Container"}),"\n",(0,s.jsx)(t.p,{children:"Start only the Postgres container to prepare for database restoration:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"docker compose -p reportportal up -d postgres\n"})}),"\n",(0,s.jsx)(t.h2,{id:"step-6-restore-postgres-dump",children:"Step 6: Restore Postgres Dump"}),"\n",(0,s.jsx)(t.p,{children:"Restore the database dump into the new Postgres container:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"docker exec -i -e PGPASSWORD=rppass postgres psql -U rpuser -d reportportal < reportportal24_1_postgres12_dump.sql > upgrade_db.log 2>&1\n"})}),"\n",(0,s.jsx)(t.h2,{id:"step-7-run-reportportal",children:"Step 7: Run ReportPortal"}),"\n",(0,s.jsx)(t.p,{children:"Bring up all the services for ReportPortal:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"docker compose -p reportportal up -d\n"})}),"\n",(0,s.jsx)(t.h2,{id:"final-notes",children:"Final Notes"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Verify that all services are running correctly using ",(0,s.jsx)(t.code,{children:"docker ps"})," or checking the logs."]}),"\n",(0,s.jsxs)(t.li,{children:["Keep the log file ",(0,s.jsx)(t.code,{children:"upgrade_db.log"})," for any potential troubleshooting."]}),"\n",(0,s.jsx)(t.li,{children:"Regular backups are essential. Make sure to have a reliable strategy in place."}),"\n"]})]})}function c(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(i,{...e})}):i(e)}},28453:(e,t,r)=>{r.d(t,{R:()=>a,x:()=>l});var o=r(96540);const s={},n=o.createContext(s);function a(e){const t=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),o.createElement(n.Provider,{value:t},e.children)}}}]);