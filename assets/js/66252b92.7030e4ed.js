"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[8909],{56187:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"installation-steps-advanced/file-storage-options/S3CloudStorage","title":"S3 Cloud Storage","description":"Access and Secret Keys authentication","source":"@site/docs/installation-steps-advanced/file-storage-options/S3CloudStorage.md","sourceDirName":"installation-steps-advanced/file-storage-options","slug":"/installation-steps-advanced/file-storage-options/S3CloudStorage","permalink":"/docs/installation-steps-advanced/file-storage-options/S3CloudStorage","draft":false,"unlisted":false,"editUrl":"https://github.com/reportportal/docs/blob/develop/docs/installation-steps-advanced/file-storage-options/S3CloudStorage.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"S3 Cloud Storage"},"sidebar":"docs","previous":{"title":"File storage options","permalink":"/docs/installation-steps-advanced/file-storage-options/"},"next":{"title":"Scaling ReportPortal services","permalink":"/docs/installation-steps-advanced/ScalingReportPortalServices"}}');var i=s(74848),a=s(28453);const o={sidebar_position:1,sidebar_label:"S3 Cloud Storage"},r="S3 Cloud Storage",c={},l=[{value:"Access and Secret Keys authentication",id:"access-and-secret-keys-authentication",level:2},{value:"Docker-based",id:"docker-based",level:3},{value:"IAM Role-based authentication",id:"iam-role-based-authentication",level:2},{value:"Amazon EKS-based",id:"amazon-eks-based",level:3},{value:"1. S3 Bucket",id:"1-s3-bucket",level:4},{value:"2. AWS IAM Role",id:"2-aws-iam-role",level:4},{value:"Step 1: Define the Trust Policy",id:"step-1-define-the-trust-policy",level:5},{value:"Step 2: Create the IAM Role",id:"step-2-create-the-iam-role",level:5},{value:"Step 3: Define the Permissions Policy",id:"step-3-define-the-permissions-policy",level:5},{value:"Step 4: Attach the Permissions Policy",id:"step-4-attach-the-permissions-policy",level:5},{value:"3. EKS-based Installation",id:"3-eks-based-installation",level:4},{value:"EC2 Docker-based",id:"ec2-docker-based",level:3},{value:"1. S3 Bucket",id:"1-s3-bucket-1",level:4},{value:"2. AWS IAM Role",id:"2-aws-iam-role-1",level:4},{value:"Step 1: Define the Trust Policy",id:"step-1-define-the-trust-policy-1",level:5},{value:"Step 2: Create the IAM Role",id:"step-2-create-the-iam-role-1",level:5},{value:"Step 3: Define the Permissions Policy",id:"step-3-define-the-permissions-policy-1",level:5},{value:"Step 4: Attach the Permissions Policy",id:"step-4-attach-the-permissions-policy-1",level:5},{value:"3. IAM Instance Profile",id:"3-iam-instance-profile",level:4},{value:"Step 1: Create an Instance Profile",id:"step-1-create-an-instance-profile",level:5},{value:"Step 2: Attach the Role to the Instance Profile",id:"step-2-attach-the-role-to-the-instance-profile",level:5},{value:"Step 3: Associate the Profile with the EC2 Instance",id:"step-3-associate-the-profile-with-the-ec2-instance",level:5},{value:"Step 4: Enable Instance Metadata Access",id:"step-4-enable-instance-metadata-access",level:5},{value:"4. ReportPortal Configuration",id:"4-reportportal-configuration",level:4},{value:"5. Docker-Based Installation",id:"5-docker-based-installation",level:4}];function d(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"s3-cloud-storage",children:"S3 Cloud Storage"})}),"\n",(0,i.jsx)(n.h2,{id:"access-and-secret-keys-authentication",children:"Access and Secret Keys authentication"}),"\n",(0,i.jsx)(n.h3,{id:"docker-based",children:"Docker-based"}),"\n",(0,i.jsxs)(n.p,{children:["ReportPortal supports cloud storage options through the Java library ",(0,i.jsx)(n.a,{href:"https://jclouds.apache.org/",children:"JCLOUDS"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["To configure storage using Amazon S3, ReportPortal uses the following environment variables for the services ",(0,i.jsx)(n.strong,{children:"API"}),", ",(0,i.jsx)(n.strong,{children:"Jobs"}),", and ",(0,i.jsx)(n.strong,{children:"Authorization"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"RP_FEATURE_FLAGS: singleBucket          # Enable single-bucket storage (recommended)\nDATASTORE_TYPE: s3\nDATASTORE_REGION: us-standard           # Region of the bucket (JCloud ref. to `us-east-1`)\nDATASTORE_ACCESSKEY: <access_key>\nDATASTORE_SECRETKEY: <secret_key>\nDATASTORE_DEFAULTBUCKETNAME: my-bucket  # Name of the bucket\n"})}),"\n",(0,i.jsx)(n.h2,{id:"iam-role-based-authentication",children:"IAM Role-based authentication"}),"\n",(0,i.jsx)(n.h3,{id:"amazon-eks-based",children:"Amazon EKS-based"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#1-s3-bucket",children:"S3 Bucket"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#2-aws-iam-role",children:"AWS IAM Role"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-1-define-the-trust-policy",children:"Step 1: Define the Trust Policy"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-2-create-the-iam-role",children:"Step 2: Create the IAM Role"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-3-define-the-permissions-policy",children:"Step 3: Define the Permissions Policy"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-4-attach-the-permissions-policy",children:"Step 4: Attach the Permissions Policy"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#3-eks-based-installation",children:"EKS-based Installation"})}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"1-s3-bucket",children:"1. S3 Bucket"}),"\n",(0,i.jsxs)(n.p,{children:["Create an Amazon S3 bucket to store your data. Replace ",(0,i.jsx)(n.code,{children:"my-rp-bucket"})," with a unique bucket name and specify the desired AWS region."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws s3api create-bucket --bucket my-rp-bucket --region us-east-1\n"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["To create a bucket outside of the ",(0,i.jsx)(n.code,{children:"us-east-1"})," region, add the following flag: ",(0,i.jsx)(n.code,{children:"--create-bucket-configuration LocationConstraint=<region>"}),", replacing ",(0,i.jsx)(n.code,{children:"<region>"})," with your desired AWS region."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Ensure that the bucket name adheres to ",(0,i.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucketnamingrules.html",children:"Amazon S3 bucket naming rules"}),"."]}),"\n",(0,i.jsx)(n.h4,{id:"2-aws-iam-role",children:"2. AWS IAM Role"}),"\n",(0,i.jsx)(n.p,{children:"To enable secure access to your S3 bucket, you need to create an AWS IAM role with the appropriate trust and permissions policies."}),"\n",(0,i.jsx)(n.h5,{id:"step-1-define-the-trust-policy",children:"Step 1: Define the Trust Policy"}),"\n",(0,i.jsxs)(n.p,{children:["The trust policy specifies which AWS service or entity is allowed to assume the role. Save the following JSON content to a file named ",(0,i.jsx)(n.code,{children:"trust-policy.json"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Effect": "Allow",\n            "Principal": {\n                "Federated": "arn:aws:iam::ACCOUNT_ID:oidc-provider/oidc.eks.REGION.amazonaws.com/id/OIDC_ID"\n            },\n            "Action": "sts:AssumeRoleWithWebIdentity",\n            "Condition": {\n                "StringEquals": {\n                    "oidc.eks.REGION.amazonaws.com/id/OIDC_ID:aud": "sts.amazonaws.com",\n                    "oidc.eks.REGION.amazonaws.com/id/OIDC_ID:sub": "system:serviceaccount:NAMESPACE:reportportal"\n                }\n            }\n        }\n    ]\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Replace the placeholders with the appropriate values:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ACCOUNT_ID"}),": Your AWS account ID."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"REGION"}),": The AWS region where your EKS cluster is deployed."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"OIDC_ID"}),": The unique identifier of your OIDC provider. ",(0,i.jsx)(n.a,{href:"https://docs.aws.amazon.com/eks/latest/userguide/enable-iam-roles-for-service-accounts.html",children:"How to create an IAM OIDC provider for your cluster"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"NAMESPACE"}),": The Kubernetes namespace of the service account."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"reportportal"}),": The name of the Kubernetes service account."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This trust policy ensures that only the specified Kubernetes service account can assume the IAM role via the OIDC provider."}),"\n",(0,i.jsx)(n.h5,{id:"step-2-create-the-iam-role",children:"Step 2: Create the IAM Role"}),"\n",(0,i.jsx)(n.p,{children:"Use the AWS CLI to create the IAM role with  the trust policy:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws iam create-role --role-name my-rp-s3-role \\\n    --assume-role-policy-document file://trust-policy.json\n"})}),"\n",(0,i.jsx)(n.h5,{id:"step-3-define-the-permissions-policy",children:"Step 3: Define the Permissions Policy"}),"\n",(0,i.jsxs)(n.p,{children:["The permissions policy specifies the actions the IAM role can perform on the S3 bucket. Save the following JSON content to a file named ",(0,i.jsx)(n.code,{children:"s3-rw-policy.json"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Sid": "AllowListAndLocation",\n            "Effect": "Allow",\n            "Action": [\n                "s3:ListBucket",\n                "s3:GetBucketLocation"\n            ],\n            "Resource": "arn:aws:s3:::my-rp-bucket"\n        },\n        {\n            "Sid": "AllowObjectOpsAnywhere",\n            "Effect": "Allow",\n            "Action": [\n                "s3:PutObject",\n                "s3:GetObject",\n                "s3:DeleteObject",\n                "s3:GetObjectAcl",\n                "s3:GetObjectVersion"\n            ],\n            "Resource": "arn:aws:s3:::my-rp-bucket/*"\n        }\n    ]\n}\n'})}),"\n",(0,i.jsx)(n.h5,{id:"step-4-attach-the-permissions-policy",children:"Step 4: Attach the Permissions Policy"}),"\n",(0,i.jsx)(n.p,{children:"Attach the permissions policy to the IAM role using the AWS CLI:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws iam put-role-policy --role-name my-rp-s3-role \\\n    --policy-name S3AccessPolicy \\\n    --policy-document file://s3-rw-policy.json\n"})}),"\n",(0,i.jsx)(n.p,{children:"By completing these steps, the IAM role will have the necessary permissions to interact with the specified S3 bucket securely."}),"\n",(0,i.jsx)(n.h4,{id:"3-eks-based-installation",children:"3. EKS-based Installation"}),"\n",(0,i.jsx)(n.p,{children:"To grant a Kubernetes pod on EKS read/write access to S3, use IAM Roles for Service Accounts (IRSA). This approach issues temporary credentials by having the pod assume an IAM role via OIDC"}),"\n",(0,i.jsxs)(n.p,{children:["Update the ",(0,i.jsx)(n.code,{children:"values.yaml"})," file with the appropriate storage configuration:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# Activate Service Account for the ReportPortal application\nglobal:\n  serviceAccount:\n    create: true\n    name: reportportal\n    annotations:\n      eks.amazonaws.com/role-arn: "arn:aws:iam::ACCOUNT_ID:role/my-rp-s3-role"\n\n\nstorage:\n  # Ref.: https://reportportal.io/docs/installation-steps-advanced/file-storage-options/\n  type: s3\n  # Leave `accesskey` and `secretkey` empty for IAM role-based access\n  accesskey:\n  secretkey:\n  # Specify the AWS region. Ref.: https://jclouds.apache.org/reference/javadoc/2.6.x/org/jclouds/aws/domain/Region.html\n  region: "us-standard" # JCloud ref. to `us-east-1`\n  bucket:\n    type: single\n    bucketDefaultName: "my-rp-bucket" # Bucket created from step 1\n\n# Disable the MinIO dependency\nminio:\n  enable: false\n'})}),"\n",(0,i.jsx)(n.p,{children:"Install ReportPortal using Helm:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'helm install my-release \\\n  --set uat.superadminInitPasswd.password="MyPassword" \\\n  -f values.yaml \\\n  reportportal/reportportal\n'})}),"\n",(0,i.jsx)(n.p,{children:"This configuration ensures that ReportPortal uses Amazon S3 for storage with IAM role-based access, while disabling the default MinIO dependency."}),"\n",(0,i.jsx)(n.h3,{id:"ec2-docker-based",children:"EC2 Docker-based"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#1-s3-bucket",children:"S3 Bucket"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#2-aws-iam-role",children:"AWS IAM Role"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-1-define-the-trust-policy",children:"Step 1: Define the Trust Policy"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-2-create-the-iam-role",children:"Step 2: Create the IAM Role"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-3-define-the-permissions-policy",children:"Step 3: Define the Permissions Policy"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-4-attach-the-permissions-policy",children:"Step 4: Attach the Permissions Policy"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#3-iam-instance-profile",children:"IAM Instance Profile"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-1-create-an-instance-profile",children:"Step 1: Create an Instance Profile"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-2-attach-the-role-to-the-instance-profile",children:"Step 2: Attach the Role to the Instance Profile"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-3-associate-the-profile-with-the-ec2-instance",children:"Step 3: Associate the Profile with the EC2 Instance"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#step-4-enable-instance-metadata-access",children:"Step 4: Enable Instance Metadata Access"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#4-reportportal-configuration",children:"ReportPortal Configuration"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#5-docker-based-installation",children:"Docker-Based Installation"})}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"1-s3-bucket-1",children:"1. S3 Bucket"}),"\n",(0,i.jsx)(n.p,{children:"Create an Amazon S3 bucket to store ReportPortal data:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws s3api create-bucket --bucket my-rp-docker-bucket --region us-east-1\n"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["\ud83d\udca1 To create a bucket outside ",(0,i.jsx)(n.code,{children:"us-east-1"}),", add the following option:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"--create-bucket-configuration LocationConstraint=<region>\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Ensure your bucket name complies with ",(0,i.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucketnamingrules.html",children:"S3 bucket naming rules"}),"."]}),"\n",(0,i.jsx)(n.h4,{id:"2-aws-iam-role-1",children:"2. AWS IAM Role"}),"\n",(0,i.jsx)(n.p,{children:"The IAM role enables the EC2 instance to assume identity and access S3 using instance metadata."}),"\n",(0,i.jsx)(n.h5,{id:"step-1-define-the-trust-policy-1",children:"Step 1: Define the Trust Policy"}),"\n",(0,i.jsxs)(n.p,{children:["Save the following to a file named ",(0,i.jsx)(n.code,{children:"trust-policy.json"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Effect": "Allow",\n            "Action": [\n                "sts:AssumeRole"\n            ],\n            "Principal": {\n                "Service": [\n                    "ec2.amazonaws.com"\n                ]\n            }\n        }\n    ]\n}\n'})}),"\n",(0,i.jsx)(n.h5,{id:"step-2-create-the-iam-role-1",children:"Step 2: Create the IAM Role"}),"\n",(0,i.jsx)(n.p,{children:"Create the role using the trust policy:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws iam create-role --role-name my-ec2-rp-s3-role \\\n    --assume-role-policy-document file://trust-policy.json\n"})}),"\n",(0,i.jsx)(n.h5,{id:"step-3-define-the-permissions-policy-1",children:"Step 3: Define the Permissions Policy"}),"\n",(0,i.jsxs)(n.p,{children:["Save the following to ",(0,i.jsx)(n.code,{children:"s3-rw-policy.json"}),", replacing ",(0,i.jsx)(n.code,{children:"my-rp-docker-bucket"})," with your bucket name:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Sid": "AllowListAndLocation",\n            "Effect": "Allow",\n            "Action": [\n                "s3:ListBucket",\n                "s3:GetBucketLocation"\n            ],\n            "Resource": "arn:aws:s3:::my-rp-docker-bucket"\n        },\n        {\n            "Sid": "AllowObjectOpsAnywhere",\n            "Effect": "Allow",\n            "Action": [\n                "s3:PutObject",\n                "s3:GetObject",\n                "s3:DeleteObject",\n                "s3:GetObjectAcl",\n                "s3:GetObjectVersion"\n            ],\n            "Resource": "arn:aws:s3:::my-rp-docker-bucket/*"\n        }\n    ]\n}\n'})}),"\n",(0,i.jsx)(n.h5,{id:"step-4-attach-the-permissions-policy-1",children:"Step 4: Attach the Permissions Policy"}),"\n",(0,i.jsx)(n.p,{children:"Attach the inline policy to the role:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws iam put-role-policy --role-name my-ec2-rp-s3-role \\\n    --policy-name S3AccessPolicy \\\n    --policy-document file://s3-rw-policy.json\n"})}),"\n",(0,i.jsx)(n.h4,{id:"3-iam-instance-profile",children:"3. IAM Instance Profile"}),"\n",(0,i.jsx)(n.h5,{id:"step-1-create-an-instance-profile",children:"Step 1: Create an Instance Profile"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws iam create-instance-profile --instance-profile-name my-ec2-rp-s3-profile\n"})}),"\n",(0,i.jsx)(n.h5,{id:"step-2-attach-the-role-to-the-instance-profile",children:"Step 2: Attach the Role to the Instance Profile"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws iam add-role-to-instance-profile \\\n    --instance-profile-name my-ec2-rp-s3-profile \\\n    --role-name my-ec2-rp-s3-role\n"})}),"\n",(0,i.jsx)(n.h5,{id:"step-3-associate-the-profile-with-the-ec2-instance",children:"Step 3: Associate the Profile with the EC2 Instance"}),"\n",(0,i.jsxs)(n.p,{children:["Replace ",(0,i.jsx)(n.code,{children:"INSTANCE_ID"})," with your EC2 instance ID:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws ec2 associate-iam-instance-profile \\\n    --region us-east-1 \\\n    --instance-id <INSTANCE_ID> \\\n    --iam-instance-profile Name=my-ec2-rp-s3-profile\n"})}),"\n",(0,i.jsx)(n.h5,{id:"step-4-enable-instance-metadata-access",children:"Step 4: Enable Instance Metadata Access"}),"\n",(0,i.jsx)(n.p,{children:"To allow a Docker container to access IMDSv2 metadata, you must increase the instance metadata service (IMDS) hop limit in the EC2 instance configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"aws ec2 modify-instance-metadata-options \\\n    --instance-id <INSTANCE_ID> \\\n    --http-put-response-hop-limit 2 \\\n    --http-endpoint enabled \\\n    --region us-east-1\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Ref.: ",(0,i.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html",children:"Access instance metadata for an EC2 instance (AWS Docs)"})]}),"\n",(0,i.jsx)(n.h4,{id:"4-reportportal-configuration",children:"4. ReportPortal Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["In your ",(0,i.jsx)(n.code,{children:"docker-compose.yml"}),", configure ReportPortal to use IAM-based S3 access:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'x-environment: &common-environment\n  # IAM Role-Based S3 Access - Leave credentials empty\n  DATASTORE_ACCESSKEY: ""\n  DATASTORE_SECRETKEY: ""\n  DATASTORE_TYPE: s3\n  DATASTORE_REGION: us-standard      # JClouds alias for us-east-1\n  DATASTORE_DEFAULTBUCKETNAME: my-rp-docker-bucket\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["For full configuration options, see the ",(0,i.jsx)(n.a,{href:"/installation-steps-advanced/file-storage-options/",children:"ReportPortal S3 integration guide"}),"."]})}),"\n",(0,i.jsx)(n.h4,{id:"5-docker-based-installation",children:"5. Docker-Based Installation"}),"\n",(0,i.jsx)(n.p,{children:"Launch ReportPortal with Docker Compose:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker-compose -p reportportal up -d --force-recreate\n"})}),"\n",(0,i.jsx)(n.p,{children:"This step brings up all ReportPortal services configured to use S3 as the storage backend with IAM role-based credentials via EC2 instance metadata."})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>r});var t=s(96540);const i={},a=t.createContext(i);function o(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);