"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[3576],{57544:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"issues-troubleshooting/ResolveAnalyzerKnownIssues","title":"Resolve Analyzer Known Issues","description":"Problem 1. Auto-Analyser doesn\'t work. Analyzer health check status failed: OpenSearch is not healthy","source":"@site/docs/issues-troubleshooting/ResolveAnalyzerKnownIssues.mdx","sourceDirName":"issues-troubleshooting","slug":"/issues-troubleshooting/ResolveAnalyzerKnownIssues","permalink":"/docs/issues-troubleshooting/ResolveAnalyzerKnownIssues","draft":false,"unlisted":false,"editUrl":"https://github.com/reportportal/docs/blob/develop/docs/issues-troubleshooting/ResolveAnalyzerKnownIssues.mdx","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"sidebar_label":"Resolve Analyzer Known Issues"},"sidebar":"docs","previous":{"title":"Issues with LDAPS: how to resolve","permalink":"/docs/issues-troubleshooting/IssuesWithLDAPSHowToResolve"},"next":{"title":"How to check LDAP connection","permalink":"/docs/issues-troubleshooting/HowToCheckLDAPConnection"}}');var s=o(74848),t=o(28453);const l={sidebar_position:6,sidebar_label:"Resolve Analyzer Known Issues"},i="Resolve Analyzer Known Issues",a={},c=[{value:"Problem 1. Auto-Analyser doesn&#39;t work. Analyzer health check status failed: OpenSearch is not healthy",id:"problem-1-auto-analyser-doesnt-work-analyzer-health-check-status-failed-opensearch-is-not-healthy",level:2},{value:"Problem Description",id:"problem-description",level:3},{value:"Solution",id:"solution",level:3},{value:"Problem 2. Auto-Analyser doesn&#39;t work. KeyError: &#39;found_test_and_methods&#39; not found",id:"problem-2-auto-analyser-doesnt-work-keyerror-found_test_and_methods-not-found",level:2},{value:"Problem Description",id:"problem-description-1",level:3},{value:"Solution",id:"solution-1",level:3},{value:"Problem 3. Amqp connection was not established",id:"problem-3-amqp-connection-was-not-established",level:2},{value:"Problem Description",id:"problem-description-2",level:3},{value:"Solution",id:"solution-2",level:3},{value:"Problem 4. Performance",id:"problem-4-performance",level:2},{value:"Problem Description",id:"problem-description-3",level:3},{value:"Solution",id:"solution-3",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components},{MediaViewer:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("MediaViewer",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"resolve-analyzer-known-issues",children:"Resolve Analyzer Known Issues"})}),"\n",(0,s.jsx)(n.h2,{id:"problem-1-auto-analyser-doesnt-work-analyzer-health-check-status-failed-opensearch-is-not-healthy",children:"Problem 1. Auto-Analyser doesn't work. Analyzer health check status failed: OpenSearch is not healthy"}),"\n",(0,s.jsx)(n.h3,{id:"problem-description",children:"Problem Description"}),"\n",(0,s.jsx)(n.p,{children:"Analyzer log:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"2021-09-09 11:34:47,927 - analyzerApp - ERROR - Analyzer health check status failed: OpenSearch is not healthy;\n[pid: 10|app: 0|req: 1/3] 127.0.0.1 () {28 vars in 294 bytes} [Thu Sep  9 11:34:46 2021] GET / => generated 43 bytes in 1643 msecs (HTTP/1.1 503) 3 headers in 120 bytes (1 switches on core 0)\n2021-09-09 11:35:48,737 - analyzerApp.utils - ERROR - Error with loading url: http://opensearch:9200/_cluster/health\n2021-09-09 11:35:48,752 - analyzerApp.utils - ERROR - HTTPConnectionPool(host='opensearch', port=9200): Max retries exceeded with url: /_cluster/health (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f5cb82d4290>: Failed to establish a new connection: [Errno 111] Connection refused'))\n2021-09-09 11:35:48,753 - analyzerApp.esclient - ERROR - OpenSearch is not healthy\n2021-09-09 11:35:48,753 - analyzerApp.esclient - ERROR - list indices must be integers or slices, not str\n"})}),"\n",(0,s.jsx)(n.p,{children:"OpenSearch container restarting all the time:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"STATUS                                     NAMES\nUp Less than a second (health: starting)   reportportal_opensearch_1\n"})}),"\n",(0,s.jsx)(n.h3,{id:"solution",children:"Solution"}),"\n",(0,s.jsx)(n.p,{children:"Create a directory for OpenSearch and assign permissions with the following commands"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mkdir -p data/opensearch\nchmod 777 data/opensearch\nchgrp 1000 data/opensearch\n"})}),"\n",(0,s.jsx)(n.p,{children:"Recreate ReportPortal services."}),"\n",(0,s.jsx)(n.h2,{id:"problem-2-auto-analyser-doesnt-work-keyerror-found_test_and_methods-not-found",children:"Problem 2. Auto-Analyser doesn't work. KeyError: 'found_test_and_methods' not found"}),"\n",(0,s.jsx)(n.h3,{id:"problem-description-1",children:"Problem Description"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"2021-09-09 11:35:48,737 - analyzerApp.utils - ERROR - KeyError: 'found_test_and_methods' not found\n"})}),"\n",(0,s.jsx)(n.h3,{id:"solution-1",children:"Solution"}),"\n",(0,s.jsx)(n.p,{children:"Regenerate index in the OpenSearch. Project settings -> Auto-Analysis -> Genetate Index"}),"\n",(0,s.jsx)(r,{src:o(51572),alt:"Auto Analyzer Generate Index in our centralized test automation tool"}),"\n",(0,s.jsx)(n.h2,{id:"problem-3-amqp-connection-was-not-established",children:"Problem 3. Amqp connection was not established"}),"\n",(0,s.jsx)(n.h3,{id:"problem-description-2",children:"Problem Description"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"2021-09-09 11:32:00,579 - analyzerApp - INFO - Starting waiting for AMQP connection\n2021-09-09 11:32:00,586 - analyzerApp.amqp - INFO - Try connect to amqp://rabbitmq:5672/analyzer?heartbeat=600\n2021-09-09 11:32:00,595 - analyzerApp - ERROR - Amqp connection was not established\n"})}),"\n",(0,s.jsx)(n.h3,{id:"solution-2",children:"Solution"}),"\n",(0,s.jsxs)(n.p,{children:["RabbitMQ container is not running. Wait for status ",(0,s.jsx)(n.code,{children:"running"})," or recreate the RabbitMQ container."]}),"\n",(0,s.jsx)(n.h2,{id:"problem-4-performance",children:"Problem 4. Performance"}),"\n",(0,s.jsx)(n.h3,{id:"problem-description-3",children:"Problem Description"}),"\n",(0,s.jsx)(n.p,{children:"Slowing down analysis or waiting for a long time fore responce."}),"\n",(0,s.jsx)(n.p,{children:"Analyzer logs:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"DAMN ! worker 1 (pid: 9191) died, killed by signal 9 :( trying respawn ...\nRespawned uWSGI worker 1 (new pid: 9490)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"solution-3",children:"Solution"}),"\n",(0,s.jsx)(n.p,{children:"Increase VM stats. We recommend using the minimum memory:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/reportportal/reportportal/blob/master/docker-compose.yml#L56",children:"Analyzer"})," - 1024 Mb"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/reportportal/reportportal/blob/master/docker-compose.yml#L69",children:"Analyzer train"})," - 512 Mb"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Also you can reduce the number of Analyzer processes with processing environment variable ",(0,s.jsx)(n.code,{children:"UWSGI_WORKERS: 2"})," (default ",(0,s.jsx)(n.code,{children:"4"}),"), then:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/reportportal/reportportal/blob/master/docker-compose.yml#L56",children:"Analyzer"})," - 768 Mb"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["However, ",(0,s.jsx)(n.code,{children:"UWSGI_WORKERS"})," will slow down the Analyzer."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},51572:(e,n,o)=>{o.r(n),o.d(n,{default:()=>r});const r=o.p+"assets/images/AutoanalyzerGenerateIndex-06654309b007ffeb1225516309f34c4f.gif"},28453:(e,n,o)=>{o.d(n,{R:()=>l,x:()=>i});var r=o(96540);const s={},t=r.createContext(s);function l(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);